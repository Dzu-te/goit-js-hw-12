{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst BASE_URL = `https://pixabay.com/api/`;\nconst API_KEY = '42024454-8ed2ac239bcd0125bd4fa3d9e';\n\nconst form = document.querySelector('.handleSearchSubmit');\nconst cardContainer = document.querySelector('.card_container');\nconst loadMoreButton = document.querySelector('.btn-show-more');\nconst hiddenClass = 'is-hidden';\nloadMoreButton.addEventListener('click', handleLoadMore);\nconst loader = document.querySelector('.loader');\n\nconst lightbox = new SimpleLightbox('.card_container a');\n\nlet currentPage = 1;\nlet searchQuery = '';\n\nfunction showErrorMessage(message) {\n  iziToast.error({\n    title: 'Error',\n    message,\n  });\n}\n\nfunction showWarningMessage(message) {\n  iziToast.warning({\n    title: 'Warning',\n    message,\n  });\n}\n\nfunction showInfo(message) {\n  iziToast.show({\n    title: 'Alert',\n    message,\n  });\n}\n\nfunction showLoader() {\n  loader.classList.remove(hiddenClass);\n}\n\nfunction hideLoader() {\n  loader.classList.add(hiddenClass);\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreButton.classList.add(hiddenClass);\n}\n\nfunction showLoadMoreButton() {\n  loadMoreButton.classList.remove(hiddenClass);\n}\n\nform.addEventListener('submit', onSearchSubmit);\n\nfunction fetchImages(q) {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: q,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page: currentPage,\n  });\n  const url = `${BASE_URL}?${params.toString()}`;\n  return axios.get(url);\n}\n\nasync function onSearchSubmit(event) {\n  event.preventDefault();\n\n  const searchInput = form.elements.search;\n  const searchValue = searchInput.value.trim();\n\n  if (!searchValue) {\n    showWarningMessage('Please enter your search term.');\n    return;\n  }\n  if (searchValue !== searchQuery) {\n    cardContainer.innerHTML = '';\n    currentPage = 1;\n  }\n\n  await processImages(searchValue);\n  form.reset();\n}\n\nfunction processSideEffects(responseLength) {\n  if (responseLength === 0 && currentPage === 1) {\n    showErrorMessage('No results were found for your request.');\n    return;\n  }\n\n  if (responseLength < 15) {\n    showInfo(\"We're sorry, but you've reached the end of search results.\");\n    return;\n  }\n\n  showLoadMoreButton();\n}\n\nasync function processImages(q) {\n  try {\n    showLoader();\n    hideLoadMoreButton();\n    const response = await fetchImages(q);\n    searchQuery = q;\n    processSideEffects(response.data.hits.length);\n    renderImages(response.data.hits);\n  } catch (error) {\n    showErrorMessage(\n      'Error fetching images: An error occurred while fetching images. Please try again later.'\n    );\n  } finally {\n    hideLoader();\n  }\n}\n\n// ==============================================\n\nasync function handleLoadMore(event) {\n  currentPage += 1;\n  await processImages(searchQuery);\n}\n// ===============================================\n\nfunction renderImages(images) {\n  const markup = images\n    .map(\n      image => `\n    <a class=\"card\" href=\"${image.largeImageURL}\">\n  <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n  <div class=\"info\">\n    <span class=\"info-item\">\n      <strong>Likes:</strong>\n      <p class=\"info-item-count\">${image.likes}</p>\n    </span>\n\n    <span class=\"info-item\">\n      <strong>Views:</strong>\n      <p class=\"info-item-count\">${image.views}</p>\n    </span>\n\n    <span class=\"info-item\">\n      <strong>Comments:</strong>\n      <p class=\"info-item-count\">${image.comments}</p>\n    </span>\n\n    <span class=\"info-item\">\n      <strong>Downloads:</strong>\n      <p class=\"info-item-count\">${image.downloads}</p>\n    </span>\n  </div>\n</a>\n  `\n    )\n    .join('');\n\n  cardContainer.innerHTML += markup;\n  lightbox.refresh();\n}\n"],"names":["BASE_URL","API_KEY","form","cardContainer","loadMoreButton","hiddenClass","handleLoadMore","loader","lightbox","SimpleLightbox","currentPage","searchQuery","showErrorMessage","message","iziToast","showWarningMessage","showInfo","showLoader","hideLoader","hideLoadMoreButton","showLoadMoreButton","onSearchSubmit","fetchImages","q","params","url","axios","event","searchValue","processImages","processSideEffects","responseLength","response","renderImages","images","markup","image"],"mappings":"owBAMA,MAAMA,EAAW,2BACXC,EAAU,qCAEVC,EAAO,SAAS,cAAc,qBAAqB,EACnDC,EAAgB,SAAS,cAAc,iBAAiB,EACxDC,EAAiB,SAAS,cAAc,gBAAgB,EACxDC,EAAc,YACpBD,EAAe,iBAAiB,QAASE,CAAc,EACvD,MAAMC,EAAS,SAAS,cAAc,SAAS,EAEzCC,EAAW,IAAIC,EAAe,mBAAmB,EAEvD,IAAIC,EAAc,EACdC,EAAc,GAElB,SAASC,EAAiBC,EAAS,CACjCC,EAAS,MAAM,CACb,MAAO,QACP,QAAAD,CACJ,CAAG,CACH,CAEA,SAASE,EAAmBF,EAAS,CACnCC,EAAS,QAAQ,CACf,MAAO,UACP,QAAAD,CACJ,CAAG,CACH,CAEA,SAASG,EAASH,EAAS,CACzBC,EAAS,KAAK,CACZ,MAAO,QACP,QAAAD,CACJ,CAAG,CACH,CAEA,SAASI,GAAa,CACpBV,EAAO,UAAU,OAAOF,CAAW,CACrC,CAEA,SAASa,GAAa,CACpBX,EAAO,UAAU,IAAIF,CAAW,CAClC,CAEA,SAASc,GAAqB,CAC5Bf,EAAe,UAAU,IAAIC,CAAW,CAC1C,CAEA,SAASe,GAAqB,CAC5BhB,EAAe,UAAU,OAAOC,CAAW,CAC7C,CAEAH,EAAK,iBAAiB,SAAUmB,CAAc,EAE9C,SAASC,EAAYC,EAAG,CACtB,MAAMC,EAAS,IAAI,gBAAgB,CACjC,IAAKvB,EACL,EAAGsB,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAMb,CACV,CAAG,EACKe,EAAM,GAAGzB,KAAYwB,EAAO,SAAU,IAC5C,OAAOE,EAAM,IAAID,CAAG,CACtB,CAEA,eAAeJ,EAAeM,EAAO,CACnCA,EAAM,eAAc,EAGpB,MAAMC,EADc1B,EAAK,SAAS,OACF,MAAM,KAAI,EAE1C,GAAI,CAAC0B,EAAa,CAChBb,EAAmB,gCAAgC,EACnD,MACD,CACGa,IAAgBjB,IAClBR,EAAc,UAAY,GAC1BO,EAAc,GAGhB,MAAMmB,EAAcD,CAAW,EAC/B1B,EAAK,MAAK,CACZ,CAEA,SAAS4B,EAAmBC,EAAgB,CAC1C,GAAIA,IAAmB,GAAKrB,IAAgB,EAAG,CAC7CE,EAAiB,yCAAyC,EAC1D,MACD,CAED,GAAImB,EAAiB,GAAI,CACvBf,EAAS,4DAA4D,EACrE,MACD,CAEDI,GACF,CAEA,eAAeS,EAAcN,EAAG,CAC9B,GAAI,CACFN,IACAE,IACA,MAAMa,EAAW,MAAMV,EAAYC,CAAC,EACpCZ,EAAcY,EACdO,EAAmBE,EAAS,KAAK,KAAK,MAAM,EAC5CC,EAAaD,EAAS,KAAK,IAAI,CAChC,MAAC,CACApB,EACE,yFACN,CACA,QAAY,CACRM,GACD,CACH,CAIA,eAAeZ,EAAeqB,EAAO,CACnCjB,GAAe,EACf,MAAMmB,EAAclB,CAAW,CACjC,CAGA,SAASsB,EAAaC,EAAQ,CAC5B,MAAMC,EAASD,EACZ,IACCE,GAAS;AAAA,4BACaA,EAAM;AAAA,cACpBA,EAAM,sBAAsBA,EAAM;AAAA;AAAA;AAAA;AAAA,mCAIbA,EAAM;AAAA;AAAA;AAAA;AAAA;AAAA,mCAKNA,EAAM;AAAA;AAAA;AAAA;AAAA;AAAA,mCAKNA,EAAM;AAAA;AAAA;AAAA;AAAA;AAAA,mCAKNA,EAAM;AAAA;AAAA;AAAA;AAAA,GAKpC,EACA,KAAK,EAAE,EAEVjC,EAAc,WAAagC,EAC3B3B,EAAS,QAAO,CAClB"}